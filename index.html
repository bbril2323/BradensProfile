import React, { useState, useEffect } from "react";
import {
  BrowserRouter as Router,
  Routes,
  Route,
  Link,
  useNavigate,
  useParams
} from "react-router-dom";

/* --------------------------
   SAMPLE PRODUCT DATA
--------------------------- */
const SAMPLE_PRODUCTS = [
  {
    id: "1",
    name: "CloudSlide Pro",
    price: 39.99,
    category: "Comfort",
    image: "https://via.placeholder.com/300x200",
    description: "Ultra-soft comfort slide for everyday wear."
  },
  {
    id: "2",
    name: "GripMax Sport Slide",
    price: 29.99,
    category: "Sport",
    image: "https://via.placeholder.com/300x200",
    description: "High-traction athletic slide built for performance."
  },
  {
    id: "3",
    name: "AquaShield Water Slide",
    price: 24.99,
    category: "Water",
    image: "https://via.placeholder.com/300x200",
    description: "Lightweight waterproof slide perfect for pools."
  }
];

/* --------------------------
   HOME PAGE
--------------------------- */
function Home() {
  return (
    <div className="page">
      <h1>Welcome to SlideCo</h1>
      <p>Your home for premium comfort slides & lifestyle footwear.</p>
      <Link className="btn" to="/shop">Shop Now</Link>
    </div>
  );
}

/* --------------------------
   ABOUT PAGE
--------------------------- */
function About() {
  return (
    <div className="page">
      <h1>About SlideCo</h1>
      <p>We design premium slides engineered for maximum comfort, durability, and style.</p>
    </div>
  );
}

/* --------------------------
   SUPPORT PAGE
--------------------------- */
function Support() {
  return (
    <div className="page">
      <h1>Support</h1>
      <p>Need help? Contact us at support@slideco.com.</p>
    </div>
  );
}

/* --------------------------
   CART PAGE
--------------------------- */
function Cart({ cart, setCart }) {
  const removeItem = (id) => {
    setCart(cart.filter((item) => item.id !== id));
  };

  return (
    <div className="page">
      <h1>Your Cart</h1>
      {cart.length === 0 ? <p>Your cart is empty.</p> : null}
      {cart.map((item) => (
        <div key={item.id} className="cart-item">
          <img src={item.image} width="120" />
          <div>
            <h2>{item.name}</h2>
            <p>${item.price}</p>
            <button onClick={() => removeItem(item.id)}>Remove</button>
          </div>
        </div>
      ))}
    </div>
  );
}

/* --------------------------
   SHOP PAGE
--------------------------- */
function Shop({ addToCart }) {
  const [search, setSearch] = useState("");
  const [sort, setSort] = useState("none");
  const [category, setCategory] = useState("All");

  const filtered = SAMPLE_PRODUCTS.filter((p) =>
    p.name.toLowerCase().includes(search.toLowerCase())
  );

  const sorted = [...filtered].sort((a, b) => {
    if (sort === "low") return a.price - b.price;
    if (sort === "high") return b.price - a.price;
    return 0;
  });

  const finalList =
    category === "All" ? sorted : sorted.filter((p) => p.category === category);

  return (
    <div className="page">
      <h1>Shop Slides</h1>

      {/* Search + Filter */}
      <input
        type="text"
        placeholder="Search slides..."
        value={search}
        onChange={(e) => setSearch(e.target.value)}
      />

      <select onChange={(e) => setSort(e.target.value)}>
        <option value="none">Sort</option>
        <option value="low">Price: Low → High</option>
        <option value="high">Price: High → Low</option>
      </select>

      <select onChange={(e) => setCategory(e.target.value)}>
        <option>All</option>
        <option>Comfort</option>
        <option>Sport</option>
        <option>Water</option>
      </select>

      <div className="product-grid">
        {finalList.map((product) => (
          <div className="product-card" key={product.id}>
            <img src={product.image} width="200" />
            <h3>{product.name}</h3>
            <p>${product.price}</p>
            <Link to={`/product/${product.id}`} className="btn">
              View
            </Link>
            <button onClick={() => addToCart(product)}>Add to Cart</button>
          </div>
        ))}
      </div>
    </div>
  );
}

/* --------------------------
   PRODUCT PAGE
--------------------------- */
function ProductPage({ addToCart }) {
  const { id } = useParams();
  const product = SAMPLE_PRODUCTS.find((p) => p.id === id);

  if (!product)
    return (
      <div className="page">
        <h2>Product not found.</h2>
      </div>
    );

  return (
    <div className="page">
      <h1>{product.name}</h1>
      <img src={product.image} width="300" />
      <p>{product.description}</p>
      <h2>${product.price}</h2>
      <button onClick={() => addToCart(product)}>Add to Cart</button>
    </div>
  );
}

/* --------------------------
   MAIN APP + ROUTES
--------------------------- */
export default function App() {
  const [cart, setCart] = useState([]);

  const addToCart = (p) => {
    setCart([...cart, p]);
  };

  return (
    <Router>
      <nav className="nav">
        <Link to="/">Home</Link>
        <Link to="/shop">Shop</Link>
        <Link to="/about">About</Link>
        <Link to="/support">Support</Link>
        <Link to="/cart">Cart ({cart.length})</Link>
      </nav>

      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/shop" element={<Shop addToCart={addToCart} />} />
        <Route path="/about" element={<About />} />
        <Route path="/support" element={<Support />} />
        <Route path="/cart" element={<Cart cart={cart} setCart={setCart} />} />
        <Route path="/product/:id" element={<ProductPage addToCart={addToCart} />} />
      </Routes>
    </Router>
  );
}

/* --------------------------
   SIMPLE STYLES
--------------------------- */
const style = document.createElement("style");
style.innerHTML = `
  body { font-family: Arial; margin: 0; background: #f4f4f4; }
  .nav { background: black; padding: 15px; display: flex; gap: 20px; }
  .nav a { color: white; text-decoration: none; }
  .page { padding: 20px; }
  .product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
  .product-card { background: white; padding: 15px; border-radius: 10px; text-align: center; }
  .btn { background: black; color: white; padding: 10px; text-decoration: none; display: inline-block; margin-top: 10px; }
  button { padding: 10px; cursor: pointer; }
  .cart-item { display: flex; gap: 20px; background: white; margin: 10px 0; padding: 15px; border-radius: 10px; }
`;
document.head.appendChild(style);

